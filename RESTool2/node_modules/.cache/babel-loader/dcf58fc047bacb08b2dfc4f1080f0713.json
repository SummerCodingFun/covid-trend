{"ast":null,"code":"import _regeneratorRuntime from\"/Users/claire/RESTool/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/claire/RESTool/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/claire/RESTool/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/claire/RESTool/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useEffect,useState}from'react';import{useParams,useHistory}from'react-router-dom';import*as QueryString from'query-string';import{toast}from'react-toastify';import{orderBy}from'natural-orderby';import{find,remove}from'lodash';import{withAppContext}from'../withContext/withContext.comp';import{Loader}from'../loader/loader.comp';import{dataHelpers}from'../../helpers/data.helpers';import{paginationHelpers}from'../../helpers/pagination.helpers';import{Table}from'../table/table.comp';import{Cards}from'../cards/cards.comp';import{QueryParams}from'../queryParams/queryParams.comp';import{Button}from'../button/button.comp';import{FormPopup}from'../formPopup/formPopup.comp';import{FilterField}from'../filterField/filterField.comp';import'./page.scss';var buildInitQueryParamsAndPaginationState=function buildInitQueryParamsAndPaginationState(initQueryParams,paginationConfig){var _paginationConfig$par,_paginationConfig$par2,_paginationConfig$par3,_paginationConfig$par4,_paginationConfig$par5,_paginationConfig$par6,_paginationConfig$par7,_paginationConfig$par8;var initialPagination=paginationConfig?{type:paginationConfig.type,page:parseInt(((_paginationConfig$par=paginationConfig.params)===null||_paginationConfig$par===void 0?void 0:(_paginationConfig$par2=_paginationConfig$par.page)===null||_paginationConfig$par2===void 0?void 0:_paginationConfig$par2.value)||'1'),limit:parseInt(((_paginationConfig$par3=paginationConfig.params)===null||_paginationConfig$par3===void 0?void 0:(_paginationConfig$par4=_paginationConfig$par3.limit)===null||_paginationConfig$par4===void 0?void 0:_paginationConfig$par4.value)||'10'),descending:((_paginationConfig$par5=paginationConfig.params)===null||_paginationConfig$par5===void 0?void 0:(_paginationConfig$par6=_paginationConfig$par5.descending)===null||_paginationConfig$par6===void 0?void 0:_paginationConfig$par6.value)==='true'||false,hasPreviousPage:false,hasNextPage:false,sortBy:(_paginationConfig$par7=paginationConfig.params)===null||_paginationConfig$par7===void 0?void 0:(_paginationConfig$par8=_paginationConfig$par7.sortBy)===null||_paginationConfig$par8===void 0?void 0:_paginationConfig$par8.value}:undefined;if(paginationConfig){var _paginationConfig$par13,_paginationConfig$par14,_paginationConfig$par15;if(!find(initQueryParams,{name:'page'})){var _paginationConfig$par9,_paginationConfig$par10,_paginationConfig$par11,_paginationConfig$par12;initQueryParams.push({name:paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par9=paginationConfig.params)===null||_paginationConfig$par9===void 0?void 0:(_paginationConfig$par10=_paginationConfig$par9.page)===null||_paginationConfig$par10===void 0?void 0:_paginationConfig$par10.name,label:(paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par11=paginationConfig.params)===null||_paginationConfig$par11===void 0?void 0:(_paginationConfig$par12=_paginationConfig$par11.page)===null||_paginationConfig$par12===void 0?void 0:_paginationConfig$par12.label)||'Page',value:initialPagination===null||initialPagination===void 0?void 0:initialPagination.page});}if((paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par13=paginationConfig.params)===null||_paginationConfig$par13===void 0?void 0:_paginationConfig$par13.limit)&&!find(initQueryParams,{name:'limit'})){initQueryParams.push({name:paginationConfig.params.limit.name,label:paginationConfig.params.limit.label||'Limit',value:initialPagination===null||initialPagination===void 0?void 0:initialPagination.limit});}if((paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par14=paginationConfig.params)===null||_paginationConfig$par14===void 0?void 0:_paginationConfig$par14.descending)&&!find(initQueryParams,{name:'descending'})){initQueryParams.push({name:paginationConfig.params.descending.name,label:paginationConfig.params.descending.label||'Descending',value:initialPagination===null||initialPagination===void 0?void 0:initialPagination.descending});}if((paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par15=paginationConfig.params)===null||_paginationConfig$par15===void 0?void 0:_paginationConfig$par15.sortBy)&&!find(initQueryParams,{name:'sortBy'})){initQueryParams.push({name:paginationConfig.params.sortBy.name,label:'Sort by',value:initialPagination===null||initialPagination===void 0?void 0:initialPagination.sortBy});}}return{initQueryParams:initQueryParams,initialPagination:initialPagination};};var PageComp=function PageComp(_ref){var _customLabels$buttons,_customLabels$formTit,_customLabels$formTit2,_openedPopup$config;var context=_ref.context;var _useParams=useParams(),page=_useParams.page;var _useHistory=useHistory(),push=_useHistory.push,location=_useHistory.location;var activePage=context.activePage,error=context.error,setError=context.setError,httpService=context.httpService,config=context.config;var pageHeaders=(activePage===null||activePage===void 0?void 0:activePage.requestHeaders)||{};var pageMethods=activePage===null||activePage===void 0?void 0:activePage.methods;var customActions=(activePage===null||activePage===void 0?void 0:activePage.customActions)||[];var getAllConfig=pageMethods===null||pageMethods===void 0?void 0:pageMethods.getAll;var paginationConfig=getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.pagination;var infiniteScroll=(paginationConfig===null||paginationConfig===void 0?void 0:paginationConfig.type)==='infinite-scroll';var getSingleConfig=pageMethods===null||pageMethods===void 0?void 0:pageMethods.getSingle;var postConfig=pageMethods===null||pageMethods===void 0?void 0:pageMethods.post;var putConfig=pageMethods===null||pageMethods===void 0?void 0:pageMethods.put;var deleteConfig=pageMethods===null||pageMethods===void 0?void 0:pageMethods.delete;var customLabels=_objectSpread({},config===null||config===void 0?void 0:config.customLabels,{},activePage===null||activePage===void 0?void 0:activePage.customLabels);var addItemLabel=(customLabels===null||customLabels===void 0?void 0:(_customLabels$buttons=customLabels.buttons)===null||_customLabels$buttons===void 0?void 0:_customLabels$buttons.addItem)||'+ Add Item';var addItemFormTitle=(customLabels===null||customLabels===void 0?void 0:(_customLabels$formTit=customLabels.formTitles)===null||_customLabels$formTit===void 0?void 0:_customLabels$formTit.addItem)||'Add Item';var editItemFormTitle=(customLabels===null||customLabels===void 0?void 0:(_customLabels$formTit2=customLabels.formTitles)===null||_customLabels$formTit2===void 0?void 0:_customLabels$formTit2.editItem)||'Update Item';var _buildInitQueryParams=buildInitQueryParamsAndPaginationState((getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.queryParams)||[],paginationConfig),initQueryParams=_buildInitQueryParams.initQueryParams,initialPagination=_buildInitQueryParams.initialPagination;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),openedPopup=_useState4[0],setOpenedPopup=_useState4[1];var _useState5=useState(initQueryParams),_useState6=_slicedToArray(_useState5,2),queryParams=_useState6[0],setQueryParams=_useState6[1];var _useState7=useState(initialPagination),_useState8=_slicedToArray(_useState7,2),pagination=_useState8[0],setPagination=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),items=_useState10[0],setItems=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),filter=_useState12[0],setFilter=_useState12[1];function closeFormPopup(){var refreshData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;setOpenedPopup(null);if(refreshData===true){if((pagination===null||pagination===void 0?void 0:pagination.type)==='infinite-scroll'){setItems([]);var updatedParams=_toConsumableArray(queryParams);remove(updatedParams,function(param){return['page','limit'].includes(param.name);});setQueryParams(buildInitQueryParamsAndPaginationState(updatedParams,paginationConfig).initQueryParams);}else{getAllRequest();}}}function openEditPopup(rawData){var params;return _regeneratorRuntime.async(function openEditPopup$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:params={rawData:rawData,type:'update',title:editItemFormTitle,config:putConfig,getSingleConfig:getSingleConfig,submitCallback:function submitCallback(body,containFiles){return _regeneratorRuntime.async(function submitCallback$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(updateItem(body,rawData,containFiles));case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}});}};setOpenedPopup(params);case 2:case\"end\":return _context2.stop();}}});}function openCustomActionPopup(rawData,action){var params={rawData:rawData,type:'action',title:action.name||'Custom Action',config:action,submitCallback:function submitCallback(body,containFiles){return _regeneratorRuntime.async(function submitCallback$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(performAction(body,rawData,action,containFiles));case 2:return _context3.abrupt(\"return\",_context3.sent);case 3:case\"end\":return _context3.stop();}}});}};setOpenedPopup(params);}function performAction(body,rawData,action,containFiles){var url,requestHeaders,actualMethod;return _regeneratorRuntime.async(function performAction$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:url=action.url,requestHeaders=action.requestHeaders,actualMethod=action.actualMethod;_context4.next=3;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'put',origUrl:url,rawData:rawData,body:containFiles?body:JSON.stringify(body),headers:_objectSpread({},pageHeaders,{},requestHeaders||{},{},containFiles?{}:{'content-type':'application/json'}),responseType:'boolean'}));case 3:return _context4.abrupt(\"return\",_context4.sent);case 4:case\"end\":return _context4.stop();}}});}function extractQueryParams(params){var parsedParams=QueryString.parse(location.search);var finalQueryParams=params.map(function(queryParam){if(typeof parsedParams[queryParam.name]!=='undefined'){queryParam.value=queryParam.type==='boolean'?parsedParams[queryParam.name]==='true':decodeURIComponent(parsedParams[queryParam.name]);}else{queryParam.value=queryParam.value||'';}return queryParam;});setPagination(getUpdatedPaginationState(finalQueryParams));return finalQueryParams;}function getAllRequest(){var url,requestHeaders,actualMethod,dataPath,sortBy,dataTransform,result,extractedData,orderedItems,_paginationConfig$fie,total,newPaginationState;return _regeneratorRuntime.async(function getAllRequest$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(infiniteScroll&&(pagination===null||pagination===void 0?void 0:pagination.page)!==1){setLoading(false);}else{setLoading(true);}setError(null);_context5.prev=2;if(getAllConfig){_context5.next=5;break;}throw new Error('Get all method is not defined.');case 5:if(!(paginationConfig&&!pagination)){_context5.next=7;break;}throw new Error('Pagination not initialized.');case 7:url=getAllConfig.url,requestHeaders=getAllConfig.requestHeaders,actualMethod=getAllConfig.actualMethod,dataPath=getAllConfig.dataPath,sortBy=getAllConfig.sortBy,dataTransform=getAllConfig.dataTransform;_context5.next=10;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'get',origUrl:url,queryParams:queryParams,headers:Object.assign({},pageHeaders,requestHeaders||{})}));case 10:result=_context5.sent;extractedData=dataHelpers.extractDataByDataPath(result,dataPath);if(extractedData){_context5.next=14;break;}throw new Error('Could not extract data from response.');case 14:if(Array.isArray(extractedData)){_context5.next=16;break;}throw new Error('Extracted data is invalid.');case 16:if(!(typeof dataTransform==='function')){_context5.next=20;break;}_context5.next=19;return _regeneratorRuntime.awrap(dataTransform(extractedData));case 19:extractedData=_context5.sent;case 20:orderedItems=orderBy(extractedData,typeof sortBy==='string'?[sortBy]:sortBy||[]);if(paginationConfig){total=((_paginationConfig$fie=paginationConfig.fields)===null||_paginationConfig$fie===void 0?void 0:_paginationConfig$fie.total)?dataHelpers.extractDataByDataPath(result,paginationConfig.fields.total.dataPath):undefined;newPaginationState=getUpdatedPaginationState(queryParams,total);if(newPaginationState){setPagination(newPaginationState);}}if(infiniteScroll){setItems([].concat(_toConsumableArray(items),_toConsumableArray(orderedItems)));}else{setItems(orderedItems);}_context5.next=28;break;case 25:_context5.prev=25;_context5.t0=_context5[\"catch\"](2);setError(_context5.t0.message);case 28:setLoading(false);case 29:case\"end\":return _context5.stop();}}},null,null,[[2,25]]);}function addItem(body,containFiles){var url,requestHeaders,actualMethod;return _regeneratorRuntime.async(function addItem$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(postConfig){_context6.next=2;break;}throw new Error('Post method is not defined.');case 2:url=postConfig.url,requestHeaders=postConfig.requestHeaders,actualMethod=postConfig.actualMethod;_context6.next=5;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'post',origUrl:url,body:containFiles?body:JSON.stringify(body),headers:_objectSpread({},pageHeaders,{},requestHeaders||{},{},containFiles?{}:{'content-type':'application/json'}),responseType:'boolean'}));case 5:return _context6.abrupt(\"return\",_context6.sent);case 6:case\"end\":return _context6.stop();}}});}function updateItem(body,rawData,containFiles){var url,requestHeaders,actualMethod;return _regeneratorRuntime.async(function updateItem$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(putConfig){_context7.next=2;break;}throw new Error('Put method is not defined.');case 2:url=putConfig.url,requestHeaders=putConfig.requestHeaders,actualMethod=putConfig.actualMethod;_context7.next=5;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'put',origUrl:url,rawData:rawData,body:containFiles?body:JSON.stringify(body),headers:_objectSpread({},pageHeaders,{},requestHeaders||{},{},containFiles?{}:{'content-type':'application/json'}),responseType:'boolean'}));case 5:return _context7.abrupt(\"return\",_context7.sent);case 6:case\"end\":return _context7.stop();}}});}function deleteItem(item){var approved,url,requestHeaders,actualMethod,success,updatedParams;return _regeneratorRuntime.async(function deleteItem$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:approved=window.confirm('Are you sure you want to delete this item?');if(approved){_context8.next=3;break;}return _context8.abrupt(\"return\");case 3:_context8.prev=3;if(deleteConfig){_context8.next=6;break;}throw new Error('Delete method is not defined.');case 6:url=deleteConfig.url,requestHeaders=deleteConfig.requestHeaders,actualMethod=deleteConfig.actualMethod;_context8.next=9;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'delete',origUrl:url,rawData:item,headers:Object.assign({},pageHeaders,requestHeaders||{}),responseType:'boolean'}));case 9:success=_context8.sent;if(success){if((pagination===null||pagination===void 0?void 0:pagination.type)==='infinite-scroll'){setItems([]);updatedParams=_toConsumableArray(queryParams);remove(updatedParams,function(param){return['page','limit'].includes(param.name);});setQueryParams(buildInitQueryParamsAndPaginationState(updatedParams,paginationConfig).initQueryParams);}else{getAllRequest();}}_context8.next=16;break;case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](3);toast.error(_context8.t0.message);case 16:case\"end\":return _context8.stop();}}},null,null,[[3,13]]);}function submitQueryParams(updatedParams,reset){if(loading){return;}if(reset){setItems([]);remove(updatedParams,function(param){return['page','limit'].includes(param.name);});updatedParams=buildInitQueryParamsAndPaginationState(updatedParams,paginationConfig).initQueryParams;}setQueryParams(updatedParams);setPagination(getUpdatedPaginationState(updatedParams));var paramsToUrl=_toConsumableArray(updatedParams);if((paginationConfig===null||paginationConfig===void 0?void 0:paginationConfig.type)==='infinite-scroll'){paramsToUrl=paramsToUrl.filter(function(param){return!['page','limit'].includes(param.name);});}// Building query string\nvar queryState=paramsToUrl.map(function(queryParam,idx){var value=queryParam.value;if(queryParam.type==='select'&&value==='-- Select --'){// default value means nothing was selected and thus we explicitly\n// empty out the value in this case; otherwise the string '-- Select --'\n// is used as the value for the given queryParams\nvalue='';}return\"\".concat(idx===0?'?':'').concat(queryParam.name,\"=\").concat(encodeURIComponent(value||''));}).join('&');// Pushing query state to url\nif(page&&queryState){push(queryState);}}function getUpdatedPaginationState(updatedParams,total){var _paginationConfig$par16,_paginationConfig$par17,_paginationConfig$par18,_paginationConfig$par19,_paginationConfig$par20,_paginationConfig$par21,_paginationConfig$par22,_paginationConfig$par23,_updatedParams$find,_updatedParams$find2,_updatedParams$find3,_updatedParams$find4;if(!paginationConfig){return;}var newState=pagination?pagination:{type:paginationConfig.type,page:parseInt(((_paginationConfig$par16=paginationConfig.params)===null||_paginationConfig$par16===void 0?void 0:(_paginationConfig$par17=_paginationConfig$par16.page)===null||_paginationConfig$par17===void 0?void 0:_paginationConfig$par17.value)||'1'),limit:parseInt(((_paginationConfig$par18=paginationConfig.params)===null||_paginationConfig$par18===void 0?void 0:(_paginationConfig$par19=_paginationConfig$par18.limit)===null||_paginationConfig$par19===void 0?void 0:_paginationConfig$par19.value)||'10'),descending:((_paginationConfig$par20=paginationConfig.params)===null||_paginationConfig$par20===void 0?void 0:(_paginationConfig$par21=_paginationConfig$par20.descending)===null||_paginationConfig$par21===void 0?void 0:_paginationConfig$par21.value)==='true'||false,hasPreviousPage:false,hasNextPage:false,sortBy:(_paginationConfig$par22=paginationConfig.params)===null||_paginationConfig$par22===void 0?void 0:(_paginationConfig$par23=_paginationConfig$par22.sortBy)===null||_paginationConfig$par23===void 0?void 0:_paginationConfig$par23.value};newState.total=total||(pagination===null||pagination===void 0?void 0:pagination.total);newState.page=parseInt((_updatedParams$find=updatedParams.find(function(param){var _paginationConfig$par24,_paginationConfig$par25;return param.name===(paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par24=paginationConfig.params)===null||_paginationConfig$par24===void 0?void 0:(_paginationConfig$par25=_paginationConfig$par24.page)===null||_paginationConfig$par25===void 0?void 0:_paginationConfig$par25.name);}))===null||_updatedParams$find===void 0?void 0:_updatedParams$find.value)||newState.page;newState.limit=parseInt((_updatedParams$find2=updatedParams.find(function(param){var _paginationConfig$par26,_paginationConfig$par27;return param.name===(paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par26=paginationConfig.params)===null||_paginationConfig$par26===void 0?void 0:(_paginationConfig$par27=_paginationConfig$par26.limit)===null||_paginationConfig$par27===void 0?void 0:_paginationConfig$par27.name);}))===null||_updatedParams$find2===void 0?void 0:_updatedParams$find2.value)||newState.limit;newState.descending=((_updatedParams$find3=updatedParams.find(function(param){var _paginationConfig$par28,_paginationConfig$par29;return param.name===(paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par28=paginationConfig.params)===null||_paginationConfig$par28===void 0?void 0:(_paginationConfig$par29=_paginationConfig$par28.descending)===null||_paginationConfig$par29===void 0?void 0:_paginationConfig$par29.name);}))===null||_updatedParams$find3===void 0?void 0:_updatedParams$find3.value)==='true'||newState.descending;newState.sortBy=((_updatedParams$find4=updatedParams.find(function(param){var _paginationConfig$par30,_paginationConfig$par31;return param.name===(paginationConfig===null||paginationConfig===void 0?void 0:(_paginationConfig$par30=paginationConfig.params)===null||_paginationConfig$par30===void 0?void 0:(_paginationConfig$par31=_paginationConfig$par30.sortBy)===null||_paginationConfig$par31===void 0?void 0:_paginationConfig$par31.name);}))===null||_updatedParams$find4===void 0?void 0:_updatedParams$find4.value)||newState.sortBy;newState.hasPreviousPage=paginationHelpers.hasPreviousPage(newState.page);newState.hasNextPage=paginationHelpers.hasNextPage(newState.page,newState.limit,newState.total);return newState;}function renderItemsUI(){var _getAllConfig$display;if(loading){return React.createElement(Loader,null);}var fields=(getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.fields)||(getAllConfig===null||getAllConfig===void 0?void 0:(_getAllConfig$display=getAllConfig.display)===null||_getAllConfig$display===void 0?void 0:_getAllConfig$display.fields)||[];var fieldsToFilter=fields.filter(function(field){return field.filterable;}).map(function(field){return field.name;});var filteredItems=items;if(filter&&fieldsToFilter.length){filteredItems=items.filter(function(item){var passFilter=false;fieldsToFilter.forEach(function(fieldName){var value=item[fieldName];if(typeof value==='string'&&value.toLowerCase().indexOf(filter)>=0){passFilter=true;}});return passFilter;});}if(!filteredItems.length){return React.createElement(\"div\",{className:\"app-error\"},\"Nothing to see here. Result is empty.\");}var getNextPage=paginationConfig?function(){if((pagination===null||pagination===void 0?void 0:pagination.page)&&queryParams.length>0){var newPage=(pagination===null||pagination===void 0?void 0:pagination.page)+1;var updatedParams=queryParams.map(function(param){var _paginationConfig$par32,_paginationConfig$par33;if(param.name===((_paginationConfig$par32=paginationConfig.params)===null||_paginationConfig$par32===void 0?void 0:(_paginationConfig$par33=_paginationConfig$par32.page)===null||_paginationConfig$par33===void 0?void 0:_paginationConfig$par33.name)){return _objectSpread({},param,{value:newPage});}return param;});submitQueryParams(updatedParams);}}:null;var getPreviousPage=paginationConfig?function(){if((pagination===null||pagination===void 0?void 0:pagination.page)&&pagination.page>1&&queryParams.length>0){var newPage=(pagination===null||pagination===void 0?void 0:pagination.page)-1;var updatedParams=queryParams.map(function(param){var _paginationConfig$par34,_paginationConfig$par35;if(param.name===((_paginationConfig$par34=paginationConfig.params)===null||_paginationConfig$par34===void 0?void 0:(_paginationConfig$par35=_paginationConfig$par34.page)===null||_paginationConfig$par35===void 0?void 0:_paginationConfig$par35.name)){return _objectSpread({},param,{value:newPage});}return param;});submitQueryParams(updatedParams);}}:null;var callbacks={delete:deleteConfig?deleteItem:null,put:putConfig?openEditPopup:null,action:customActions.length?openCustomActionPopup:function(){},getNextPage:getNextPage,getPreviousPage:getPreviousPage};if((getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.display.type)==='cards'){return React.createElement(Cards,{pagination:pagination,callbacks:callbacks,fields:fields,items:filteredItems,customActions:customActions,customLabels:customLabels});}return React.createElement(Table,{pagination:pagination,callbacks:callbacks,fields:fields,items:filteredItems,customActions:customActions,customLabels:customLabels});}function renderPaginationStateLabel(){var _customLabels$paginat;if(loading||!items.length){return;}var currentCountFrom=(((pagination===null||pagination===void 0?void 0:pagination.page)||1)-1)*((pagination===null||pagination===void 0?void 0:pagination.limit)||10)+1;var currentCountTo=currentCountFrom+items.length-1;var label=\"Showing results \".concat(currentCountFrom,\"-\").concat(currentCountTo,\" out of \").concat(pagination===null||pagination===void 0?void 0:pagination.total,\" items\");if((pagination===null||pagination===void 0?void 0:pagination.type)==='infinite-scroll'){label=\"Showing \".concat(pagination===null||pagination===void 0?void 0:pagination.total,\" items\");}if(customLabels===null||customLabels===void 0?void 0:(_customLabels$paginat=customLabels.pagination)===null||_customLabels$paginat===void 0?void 0:_customLabels$paginat.itemsCount){var _customLabels$paginat2;label=customLabels===null||customLabels===void 0?void 0:(_customLabels$paginat2=customLabels.pagination)===null||_customLabels$paginat2===void 0?void 0:_customLabels$paginat2.itemsCount.replace(':currentCountFrom',currentCountFrom).replace(':currentCountTo',currentCountFrom).replace(':totalCount',pagination===null||pagination===void 0?void 0:pagination.total);}return React.createElement(\"p\",{className:\"center pagination-state\"},label);}function renderPageContent(){var _getAllConfig$display2;var fields=(getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.fields)||(getAllConfig===null||getAllConfig===void 0?void 0:(_getAllConfig$display2=getAllConfig.display)===null||_getAllConfig$display2===void 0?void 0:_getAllConfig$display2.fields)||[];var fieldsToFilter=fields.filter(function(field){return field.filterable;}).map(function(field){return field.name;});return React.createElement(React.Fragment,null,React.createElement(QueryParams,{initialParams:queryParams,paginationConfig:paginationConfig,submitCallback:submitQueryParams}),fieldsToFilter.length>0&&React.createElement(FilterField,{onChange:setFilter}),(pagination===null||pagination===void 0?void 0:pagination.total)&&renderPaginationStateLabel(),error?React.createElement(\"div\",{className:\"app-error\"},error):renderItemsUI());}useEffect(function(){var _context$config,_context$config$pages;var nextActivePage=(context===null||context===void 0?void 0:(_context$config=context.config)===null||_context$config===void 0?void 0:(_context$config$pages=_context$config.pages)===null||_context$config$pages===void 0?void 0:_context$config$pages.filter(function(p,pIdx){return p.id===page||pIdx+1===parseInt(page||'');})[0])||null;context.setActivePage(nextActivePage);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[page]);useEffect(function(){var _buildInitQueryParams2=buildInitQueryParamsAndPaginationState((getAllConfig===null||getAllConfig===void 0?void 0:getAllConfig.queryParams)||[],paginationConfig),initQueryParams=_buildInitQueryParams2.initQueryParams,initialPagination=_buildInitQueryParams2.initialPagination;setItems([]);setQueryParams(extractQueryParams(initQueryParams));setPagination(initialPagination);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[activePage]);useEffect(function(){// Load data when query params \ngetAllRequest();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[queryParams]);return React.createElement(\"div\",{className:\"app-page\"},React.createElement(\"header\",{className:\"app-page-header\"},React.createElement(\"hgroup\",null,React.createElement(\"h2\",null,activePage===null||activePage===void 0?void 0:activePage.name),(activePage===null||activePage===void 0?void 0:activePage.description)&&React.createElement(\"h4\",null,activePage===null||activePage===void 0?void 0:activePage.description)),postConfig&&React.createElement(Button,{className:\"add-item\",color:\"green\",onClick:function onClick(){return setOpenedPopup({type:'add',title:addItemFormTitle,config:postConfig,submitCallback:addItem});}},addItemLabel)),React.createElement(\"main\",{className:\"app-page-content\"},renderPageContent()),openedPopup&&React.createElement(FormPopup,{title:openedPopup.title,closeCallback:closeFormPopup,submitCallback:openedPopup.submitCallback,fields:((_openedPopup$config=openedPopup.config)===null||_openedPopup$config===void 0?void 0:_openedPopup$config.fields)||[],rawData:openedPopup.rawData,getSingleConfig:openedPopup.getSingleConfig,methodConfig:openedPopup.config}));};export var Page=withAppContext(PageComp);","map":{"version":3,"sources":["/Users/claire/RESTool/src/components/page/page.comp.tsx"],"names":["React","useEffect","useState","useParams","useHistory","QueryString","toast","orderBy","find","remove","withAppContext","Loader","dataHelpers","paginationHelpers","Table","Cards","QueryParams","Button","FormPopup","FilterField","buildInitQueryParamsAndPaginationState","initQueryParams","paginationConfig","initialPagination","type","page","parseInt","params","value","limit","descending","hasPreviousPage","hasNextPage","sortBy","undefined","name","push","label","PageComp","context","location","activePage","error","setError","httpService","config","pageHeaders","requestHeaders","pageMethods","methods","customActions","getAllConfig","getAll","pagination","infiniteScroll","getSingleConfig","getSingle","postConfig","post","putConfig","put","deleteConfig","delete","customLabels","addItemLabel","buttons","addItem","addItemFormTitle","formTitles","editItemFormTitle","editItem","queryParams","loading","setLoading","openedPopup","setOpenedPopup","setQueryParams","setPagination","items","setItems","filter","setFilter","closeFormPopup","refreshData","updatedParams","param","includes","getAllRequest","openEditPopup","rawData","title","submitCallback","body","containFiles","updateItem","openCustomActionPopup","action","performAction","url","actualMethod","fetch","method","origUrl","JSON","stringify","headers","responseType","extractQueryParams","parsedParams","parse","search","finalQueryParams","map","queryParam","decodeURIComponent","getUpdatedPaginationState","Error","dataPath","dataTransform","Object","assign","result","extractedData","extractDataByDataPath","Array","isArray","orderedItems","total","fields","newPaginationState","message","deleteItem","item","approved","window","confirm","success","submitQueryParams","reset","paramsToUrl","queryState","idx","encodeURIComponent","join","newState","renderItemsUI","display","fieldsToFilter","field","filterable","filteredItems","length","passFilter","forEach","fieldName","toLowerCase","indexOf","getNextPage","newPage","getPreviousPage","callbacks","renderPaginationStateLabel","currentCountFrom","currentCountTo","itemsCount","replace","renderPageContent","nextActivePage","pages","p","pIdx","id","setActivePage","description","Page"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport * as QueryString from 'query-string';\nimport { toast } from 'react-toastify';\nimport { orderBy } from 'natural-orderby';\nimport { find, remove } from 'lodash';\n\nimport { IAppContext } from '../app.context';\nimport { IConfigPage, IConfigMethods, IConfigGetAllMethod, IConfigPostMethod, IConfigPutMethod, IConfigDeleteMethod, IConfigInputField, IConfigCustomAction, IConfigGetSingleMethod, ICustomLabels, IConfigPagination } from '../../common/models/config.model';\nimport { IPaginationState } from '../../common/models/states.model';\nimport { withAppContext } from '../withContext/withContext.comp';\nimport { Loader } from '../loader/loader.comp';\nimport { dataHelpers } from '../../helpers/data.helpers';\nimport { paginationHelpers } from '../../helpers/pagination.helpers';\nimport { Table } from '../table/table.comp';\nimport { Cards } from '../cards/cards.comp';\nimport { QueryParams } from '../queryParams/queryParams.comp';\nimport { Button } from '../button/button.comp';\nimport { FormPopup } from '../formPopup/formPopup.comp';\nimport { FilterField } from '../filterField/filterField.comp';\n\nimport './page.scss';\n\ninterface IProps {\n  context: IAppContext\n}\n\ninterface IPopupProps {\n  type: 'add' | 'update' | 'action'\n  title: string\n  config: IConfigPostMethod | IConfigPutMethod\n  submitCallback: (body: any, containFiles: boolean) => void\n  getSingleConfig?: IConfigGetSingleMethod\n  rawData?: {}\n}\n\nconst buildInitQueryParamsAndPaginationState = (\n  initQueryParams: IConfigInputField[],\n  paginationConfig?: IConfigPagination,\n): {\n  initQueryParams: IConfigInputField[],\n  initialPagination?: IPaginationState,\n} => {\n  const initialPagination: IPaginationState | undefined = paginationConfig ? {\n    type: paginationConfig.type,\n    page: parseInt(paginationConfig.params?.page?.value || '1'),\n    limit: parseInt(paginationConfig.params?.limit?.value || '10'),\n    descending: paginationConfig.params?.descending?.value === 'true' || false,\n    hasPreviousPage: false,\n    hasNextPage: false,\n    sortBy: paginationConfig.params?.sortBy?.value,\n  } : undefined;\n\n  if (paginationConfig) {\n    if (!find(initQueryParams, { name: 'page' })) {\n      initQueryParams.push({\n        name: paginationConfig?.params?.page?.name,\n        label: paginationConfig?.params?.page?.label || 'Page',\n        value: initialPagination?.page\n      });\n    }\n\n    if (paginationConfig?.params?.limit && !find(initQueryParams, { name: 'limit' })) {\n      initQueryParams.push({\n        name: paginationConfig.params.limit.name,\n        label: paginationConfig.params.limit.label || 'Limit',\n        value: initialPagination?.limit\n      });\n    }\n\n    if (paginationConfig?.params?.descending && !find(initQueryParams, { name: 'descending' })) {\n      initQueryParams.push({\n        name: paginationConfig.params.descending.name,\n        label: paginationConfig.params.descending.label || 'Descending',\n        value: initialPagination?.descending\n      });\n    }\n\n    if (paginationConfig?.params?.sortBy && !find(initQueryParams, { name: 'sortBy' })) {\n      initQueryParams.push({\n        name: paginationConfig.params.sortBy.name,\n        label: 'Sort by',\n        value: initialPagination?.sortBy\n      });\n    }\n  }\n\n  return {\n    initQueryParams,\n    initialPagination\n  };\n};\n\nconst PageComp = ({ context }: IProps) => {\n  const { page } = useParams();\n  const { push, location } = useHistory();\n  const { activePage, error, setError, httpService, config } = context;\n  const pageHeaders: any = activePage?.requestHeaders || {};\n  const pageMethods: IConfigMethods | undefined = activePage?.methods;\n  const customActions: IConfigCustomAction[] = activePage?.customActions || [];\n  const getAllConfig: IConfigGetAllMethod | undefined = pageMethods?.getAll;\n  const paginationConfig = getAllConfig?.pagination;\n  const infiniteScroll = paginationConfig?.type === 'infinite-scroll';\n  const getSingleConfig: IConfigGetSingleMethod | undefined = pageMethods?.getSingle;\n  const postConfig: IConfigPostMethod | undefined = pageMethods?.post;\n  const putConfig: IConfigPutMethod | undefined = pageMethods?.put;\n  const deleteConfig: IConfigDeleteMethod | undefined = pageMethods?.delete;\n  const customLabels: ICustomLabels | undefined = { ...config?.customLabels, ...activePage?.customLabels };\n  const addItemLabel = customLabels?.buttons?.addItem || '+ Add Item';\n  const addItemFormTitle = customLabels?.formTitles?.addItem || 'Add Item';\n  const editItemFormTitle = customLabels?.formTitles?.editItem || 'Update Item';\n  const { initQueryParams, initialPagination } = buildInitQueryParamsAndPaginationState(getAllConfig?.queryParams || [], paginationConfig);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [openedPopup, setOpenedPopup] = useState<null | IPopupProps>(null);\n  const [queryParams, setQueryParams] = useState<IConfigInputField[]>(initQueryParams);\n  const [pagination, setPagination] = useState<IPaginationState | undefined>(initialPagination);\n  const [items, setItems] = useState<any[]>([]);\n  const [filter, setFilter] = useState<string>('');\n\n  function closeFormPopup(refreshData: boolean = false) {\n    setOpenedPopup(null);\n\n    if (refreshData === true) {\n      if (pagination?.type === 'infinite-scroll') {\n        setItems([]);\n        const updatedParams = [...queryParams];\n        remove(updatedParams, param => ['page', 'limit'].includes(param.name));\n        setQueryParams(buildInitQueryParamsAndPaginationState(updatedParams, paginationConfig).initQueryParams);\n      } else {\n        getAllRequest();\n      }\n    }\n  }\n\n  async function openEditPopup(rawData: any) {\n    const params: IPopupProps = {\n      rawData,\n      type: 'update',\n      title: editItemFormTitle,\n      config: putConfig as IConfigPutMethod,\n      getSingleConfig,\n      submitCallback: async (body: any, containFiles: boolean) => {\n        return await updateItem(body, rawData, containFiles);\n      }\n    };\n\n    setOpenedPopup(params);\n  }\n\n  function openCustomActionPopup(rawData: any, action: IConfigCustomAction) {\n    const params: IPopupProps = {\n      rawData,\n      type: 'action',\n      title: action.name || 'Custom Action',\n      config: action as IConfigCustomAction,\n      submitCallback: async (body: any, containFiles: boolean) => {\n        return await performAction(body, rawData, action, containFiles);\n      }\n    };\n\n    setOpenedPopup(params);\n  }\n\n  async function performAction(body: any, rawData: any, action: IConfigCustomAction, containFiles: boolean) {\n    const { url, requestHeaders, actualMethod } = action;\n\n    return await httpService.fetch({\n      method: actualMethod || 'put',\n      origUrl: url,\n      rawData,\n      body: containFiles ? body : JSON.stringify(body),\n      headers: {\n        ...pageHeaders,\n        ...(requestHeaders || {}),\n        ...(containFiles ? {} : { 'content-type': 'application/json' })\n      },\n      responseType: 'boolean'\n    });\n  }\n\n  function extractQueryParams(params: IConfigInputField[]): IConfigInputField[] {\n    const parsedParams = QueryString.parse(location.search);\n    const finalQueryParams = params.map((queryParam) => {\n      if (typeof parsedParams[queryParam.name] !== 'undefined') {\n        queryParam.value = queryParam.type === 'boolean' ? (parsedParams[queryParam.name] === 'true') : decodeURIComponent(parsedParams[queryParam.name] as any);\n      } else {\n        queryParam.value = queryParam.value || '';\n      }\n      return queryParam;\n    });\n\n    setPagination(getUpdatedPaginationState(finalQueryParams))\n\n    return finalQueryParams;\n  }\n\n  async function getAllRequest() {\n    if (infiniteScroll && pagination?.page !== 1) {\n      setLoading(false);\n    } else {\n      setLoading(true);\n    }\n\n    setError(null);\n\n    try {\n      if (!getAllConfig) {\n        throw new Error('Get all method is not defined.');\n      }\n\n      if (paginationConfig && !pagination) {\n        throw new Error('Pagination not initialized.');\n      }\n\n      const { url, requestHeaders, actualMethod, dataPath, sortBy, dataTransform } = getAllConfig;\n      const result = await httpService.fetch({\n        method: actualMethod || 'get',\n        origUrl: url,\n        queryParams,\n        headers: Object.assign({}, pageHeaders, requestHeaders || {})\n      });\n      let extractedData = dataHelpers.extractDataByDataPath(result, dataPath);\n\n      if (!extractedData) {\n        throw new Error('Could not extract data from response.');\n      }\n\n      if (!Array.isArray(extractedData)) {\n        throw new Error('Extracted data is invalid.');\n      }\n\n      if (typeof dataTransform === 'function') {\n        extractedData = await dataTransform(extractedData);\n      }\n\n      const orderedItems = orderBy(extractedData, typeof sortBy === 'string' ? [sortBy] : (sortBy || []));\n\n      if (paginationConfig) {\n        const total = paginationConfig.fields?.total ? dataHelpers.extractDataByDataPath(result, paginationConfig.fields.total.dataPath) : undefined;\n        const newPaginationState = getUpdatedPaginationState(queryParams, total);\n        if (newPaginationState) {\n          setPagination(newPaginationState);\n        }\n      }\n\n      if (infiniteScroll) {\n        setItems([...items, ...orderedItems]);\n      } else {\n        setItems(orderedItems);\n      }\n\n    } catch (e) {\n      setError(e.message);\n    }\n\n    setLoading(false);\n  }\n\n  async function addItem(body: any, containFiles?: boolean) {\n    if (!postConfig) {\n      throw new Error('Post method is not defined.');\n    }\n\n    const { url, requestHeaders, actualMethod } = postConfig;\n\n    return await httpService.fetch({\n      method: actualMethod || 'post',\n      origUrl: url,\n      body: containFiles ? body : JSON.stringify(body),\n      headers: {\n        ...pageHeaders,\n        ...(requestHeaders || {}),\n        ...(containFiles ? {} : { 'content-type': 'application/json' })\n      },\n      responseType: 'boolean'\n    });\n  }\n\n  async function updateItem(body: any, rawData: any, containFiles?: boolean) {\n    if (!putConfig) {\n      throw new Error('Put method is not defined.');\n    }\n\n    const { url, requestHeaders, actualMethod } = putConfig;\n\n    return await httpService.fetch({\n      method: actualMethod || 'put',\n      origUrl: url,\n      rawData,\n      body: containFiles ? body : JSON.stringify(body),\n      headers: {\n        ...pageHeaders,\n        ...(requestHeaders || {}),\n        ...(containFiles ? {} : { 'content-type': 'application/json' })\n      },\n      responseType: 'boolean'\n    });\n  }\n\n  async function deleteItem(item: any) {\n    const approved: boolean = window.confirm('Are you sure you want to delete this item?');\n\n    if (!approved) {\n      return;\n    }\n\n    try {\n      if (!deleteConfig) {\n        throw new Error('Delete method is not defined.');\n      }\n\n      const { url, requestHeaders, actualMethod } = deleteConfig;\n      const success = await httpService.fetch({\n        method: actualMethod || 'delete',\n        origUrl: url,\n        rawData: item,\n        headers: Object.assign({}, pageHeaders, requestHeaders || {}),\n        responseType: 'boolean'\n      });\n\n      if (success) {\n        if (pagination?.type === 'infinite-scroll') {\n          setItems([]);\n          const updatedParams = [...queryParams];\n          remove(updatedParams, param => ['page', 'limit'].includes(param.name));\n          setQueryParams(buildInitQueryParamsAndPaginationState(updatedParams, paginationConfig).initQueryParams);\n        } else {\n          getAllRequest();\n        }\n      }\n    } catch (e) {\n      toast.error(e.message);\n    }\n  }\n\n  function submitQueryParams(updatedParams: IConfigInputField[], reset?: boolean) {\n    if (loading) {\n      return;\n    }\n    \n    if (reset) {\n      setItems([]);\n      remove(updatedParams, param => ['page', 'limit'].includes(param.name));\n      updatedParams = buildInitQueryParamsAndPaginationState(updatedParams, paginationConfig).initQueryParams;\n    }\n\n    setQueryParams(updatedParams);\n    setPagination(getUpdatedPaginationState(updatedParams));\n\n    let paramsToUrl = [...updatedParams];\n\n    if (paginationConfig?.type === 'infinite-scroll') {\n      paramsToUrl = paramsToUrl.filter(param => !['page', 'limit'].includes(param.name));\n    }\n\n    // Building query string\n    const queryState: string = paramsToUrl.map((queryParam, idx) => {\n      let value = queryParam.value;\n\n      if (queryParam.type === 'select' && value === '-- Select --') {\n          // default value means nothing was selected and thus we explicitly\n          // empty out the value in this case; otherwise the string '-- Select --'\n          // is used as the value for the given queryParams\n          value = '';\n      }\n\n      return `${idx === 0 ? '?' : ''}${queryParam.name}=${encodeURIComponent(value || '')}`;\n    }).join('&');\n\n    // Pushing query state to url\n    if (page && queryState) {\n      push(queryState);\n    }\n  }\n\n  function getUpdatedPaginationState(updatedParams: IConfigInputField[], total?: number): IPaginationState | undefined {\n    if (!paginationConfig) {\n      return;\n    }\n\n    const newState: IPaginationState = pagination ? pagination : {\n      type: paginationConfig.type,\n      page: parseInt(paginationConfig.params?.page?.value || '1'),\n      limit: parseInt(paginationConfig.params?.limit?.value || '10'),\n      descending: paginationConfig.params?.descending?.value === 'true' || false,\n      hasPreviousPage: false,\n      hasNextPage: false,\n      sortBy: paginationConfig.params?.sortBy?.value,\n    };\n\n    newState.total = total || pagination?.total;\n    newState.page = parseInt(updatedParams.find(param => param.name === paginationConfig?.params?.page?.name)?.value) || newState.page;\n    newState.limit = parseInt(updatedParams.find(param => param.name === paginationConfig?.params?.limit?.name)?.value) || newState.limit;\n    newState.descending = updatedParams.find(param => param.name === paginationConfig?.params?.descending?.name)?.value === 'true' || newState.descending;\n    newState.sortBy = updatedParams.find(param => param.name === paginationConfig?.params?.sortBy?.name)?.value || newState.sortBy;\n    newState.hasPreviousPage = paginationHelpers.hasPreviousPage(newState.page);\n    newState.hasNextPage = paginationHelpers.hasNextPage(newState.page, newState.limit, newState.total);\n    \n    return newState;\n  }\n\n  function renderItemsUI() {\n    if (loading) {\n      return <Loader />;\n    }\n\n    const fields = getAllConfig?.fields || getAllConfig?.display?.fields || [];\n    const fieldsToFilter = fields.filter((field) => (field.filterable)).map((field) => field.name);\n    let filteredItems = items;\n\n    if (filter && fieldsToFilter.length) {\n      filteredItems = items.filter((item) => {\n        let passFilter = false;\n        fieldsToFilter.forEach((fieldName) => {\n          const value = item[fieldName];\n          if (typeof value === 'string' && value.toLowerCase().indexOf(filter) >= 0) {\n            passFilter = true;\n          }\n        })\n        return passFilter;\n      });\n    }\n\n    if (!filteredItems.length) {\n      return <div className=\"app-error\">Nothing to see here. Result is empty.</div>;\n    }\n\n    const getNextPage = paginationConfig ? () => {\n      if (pagination?.page && queryParams.length > 0) {\n        const newPage = pagination?.page + 1;\n        const updatedParams = queryParams.map((param) => {\n          if (param.name === paginationConfig.params?.page?.name) {\n            return {\n              ...param,\n              value: newPage\n            }\n          }\n          return param;\n        });\n        submitQueryParams(updatedParams);\n      }\n    } : null;\n\n    const getPreviousPage = paginationConfig ? () => {\n      if (pagination?.page && pagination.page > 1 && queryParams.length > 0) {\n        const newPage = pagination?.page - 1;\n        const updatedParams = queryParams.map((param) => {\n          if (param.name === paginationConfig.params?.page?.name) {\n            return {\n              ...param,\n              value: newPage\n            }\n          }\n          return param;\n        });\n        submitQueryParams(updatedParams);\n      }\n    } : null;\n\n    const callbacks = {\n      delete: deleteConfig ? deleteItem : null,\n      put: putConfig ? openEditPopup : null,\n      action: customActions.length ? openCustomActionPopup : () => { },\n      getNextPage,\n      getPreviousPage,\n    };\n\n    if (getAllConfig?.display.type === 'cards') {\n      return (\n        <Cards\n          pagination={pagination}\n          callbacks={callbacks}\n          fields={fields}\n          items={filteredItems}\n          customActions={customActions}\n          customLabels={customLabels}\n        />\n      );\n    }\n\n    return (\n      <Table\n        pagination={pagination}\n        callbacks={callbacks}\n        fields={fields}\n        items={filteredItems}\n        customActions={customActions}\n        customLabels={customLabels}\n      />\n    );\n  }\n\n  function renderPaginationStateLabel() {\n    if (loading || !items.length) {\n      return;\n    }\n\n    const currentCountFrom = (((pagination?.page || 1) - 1) * (pagination?.limit || 10)) + 1;\n    const currentCountTo = currentCountFrom + items.length - 1;\n    let label: string = `Showing results ${currentCountFrom}-${currentCountTo} out of ${pagination?.total} items`;\n\n    if (pagination?.type === 'infinite-scroll') {\n      label = `Showing ${pagination?.total} items`;\n    }\n\n    if (customLabels?.pagination?.itemsCount) {\n      label = customLabels?.pagination?.itemsCount\n              .replace(':currentCountFrom', currentCountFrom as any)\n              .replace(':currentCountTo', currentCountFrom as any)\n              .replace(':totalCount', pagination?.total as any);\n    }\n\n    return (\n      <p className=\"center pagination-state\">\n        {label}\n      </p>\n    );\n  }\n\n  function renderPageContent() {\n    const fields = getAllConfig?.fields || getAllConfig?.display?.fields || [];\n    const fieldsToFilter = fields.filter((field) => (field.filterable)).map((field) => field.name);\n\n    return (\n      <React.Fragment>\n        <QueryParams\n          initialParams={queryParams}\n          paginationConfig={paginationConfig}\n          submitCallback={submitQueryParams}\n        />\n        {\n          fieldsToFilter.length > 0 &&\n          <FilterField onChange={setFilter} />\n        }\n        {\n          pagination?.total &&\n          renderPaginationStateLabel()\n        }\n        {\n          error ?\n          <div className=\"app-error\">{error}</div> :\n          renderItemsUI()\n        }\n      </React.Fragment>\n    )\n  }\n\n  useEffect(() => {\n    const nextActivePage: IConfigPage | null = context?.config?.pages?.filter((p, pIdx) => p.id === page || (pIdx + 1) === parseInt(page || ''))[0] || null;\n    context.setActivePage(nextActivePage);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [page]);\n\n  useEffect(() => {\n    const { initQueryParams, initialPagination } = buildInitQueryParamsAndPaginationState(getAllConfig?.queryParams || [], paginationConfig);\n\n    setItems([]);\n    setQueryParams(extractQueryParams(initQueryParams));\n    setPagination(initialPagination);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activePage]);\n\n  useEffect(() => {\n    // Load data when query params \n    getAllRequest();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [queryParams]);\n\n  return (\n    <div className=\"app-page\">\n      <header className=\"app-page-header\">\n        <hgroup>\n          <h2>{activePage?.name}</h2>\n          {\n            activePage?.description &&\n            <h4>{activePage?.description}</h4>\n          }\n        </hgroup>\n        {\n          postConfig &&\n          <Button className=\"add-item\" color=\"green\" onClick={() => setOpenedPopup({ type: 'add', title: addItemFormTitle, config: postConfig, submitCallback: addItem })}>{addItemLabel}</Button>\n        }\n      </header>\n      <main className=\"app-page-content\">\n        {renderPageContent()}\n      </main>\n      {\n        openedPopup &&\n        <FormPopup\n          title={openedPopup.title}\n          closeCallback={closeFormPopup}\n          submitCallback={openedPopup.submitCallback}\n          fields={openedPopup.config?.fields || []}\n          rawData={openedPopup.rawData}\n          getSingleConfig={openedPopup.getSingleConfig}\n          methodConfig={openedPopup.config}\n        />\n      }\n    </div>\n  );\n}\n\nexport const Page = withAppContext(PageComp);\n"]},"metadata":{},"sourceType":"module"}