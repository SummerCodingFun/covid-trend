{"ast":null,"code":"import _regeneratorRuntime from\"/Users/claire/Desktop/covid-trend/RESTool2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/claire/Desktop/covid-trend/RESTool2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/claire/Desktop/covid-trend/RESTool2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{toast}from'react-toastify';import{Popup}from'../popup/popup.comp';import{FormRow}from'../formRow/formRow.comp';import{Button}from'../button/button.comp';import{Loader}from'../loader/loader.comp';import{dataHelpers}from'../../helpers/data.helpers';import{fileHelpers}from'../../helpers/file.helpers';import{withAppContext}from'../withContext/withContext.comp';import'./formPopup.scss';var flatten=require('flat');var unflatten=require('flat').unflatten;export var FormPopup=withAppContext(function(_ref){var context=_ref.context,title=_ref.title,fields=_ref.fields,rawData=_ref.rawData,getSingleConfig=_ref.getSingleConfig,methodConfig=_ref.methodConfig,submitCallback=_ref.submitCallback,_closeCallback=_ref.closeCallback;var fieldsCopy=JSON.parse(JSON.stringify(fields));var httpService=context.httpService,activePage=context.activePage,config=context.config;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),formFields=_useState4[0],setFormFields=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),finalRawData=_useState6[0],setFinalRawData=_useState6[1];var pageHeaders=(activePage===null||activePage===void 0?void 0:activePage.requestHeaders)||{};var customLabels=_objectSpread({},config===null||config===void 0?void 0:config.customLabels,{},activePage===null||activePage===void 0?void 0:activePage.customLabels);function initFormFields(){var finalRawData,url,requestHeaders,actualMethod,dataPath,queryParams,result,extractedData,flattenData;return _regeneratorRuntime.async(function initFormFields$(_context){while(1){switch(_context.prev=_context.next){case 0:finalRawData=rawData||{};if(!(getSingleConfig&&getSingleConfig.url)){_context.next=15;break;}_context.prev=2;url=getSingleConfig.url,requestHeaders=getSingleConfig.requestHeaders,actualMethod=getSingleConfig.actualMethod,dataPath=getSingleConfig.dataPath,queryParams=getSingleConfig.queryParams;_context.next=6;return _regeneratorRuntime.awrap(httpService.fetch({method:actualMethod||'get',origUrl:url,queryParams:queryParams,headers:Object.assign({},pageHeaders,requestHeaders||{}),rawData:rawData}));case 6:result=_context.sent;extractedData=dataHelpers.extractDataByDataPath(result,dataPath);if(extractedData&&typeof extractedData==='object'){finalRawData=extractedData;}_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](2);console.error('Could not load single item\\'s data.',_context.t0);toast.error('Could not load single item\\'s data.');case 15:setFinalRawData(finalRawData);// Store the raw data for later.\nflattenData=flatten(finalRawData||{});setFormFields(fieldsCopy.map(function(field){var key=field.name;field.originalName=field.name;if(field.dataPath){key=\"\".concat(field.dataPath,\".\").concat(field.name);}// Changing field name to include datapath\n// This will use us later for unflatten the final object\nfield.name=key;if(dataHelpers.checkIfFieldIsObject(field)){if(finalRawData[key]||field.value){field.value=JSON.stringify(finalRawData[key]||field.value,null,'  ')||'';}return field;}if(field.type==='array'){field.value=finalRawData[key]||field.value||[];return field;}if(typeof flattenData[key]!=='undefined'){field.value=flattenData[key];}else{// important in order to prevent controlled / uncontrolled components error\nfield.value=typeof field.value==='undefined'?'':field.value;}return field;}));setLoading(false);case 19:case\"end\":return _context.stop();}}},null,null,[[2,11]]);}function submitForm(e){var finalObject,formData,containFiles,validationError,_body;return _regeneratorRuntime.async(function submitForm$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();finalObject=methodConfig.includeOriginalFields?Object.assign({},finalRawData):{};formData=new FormData();containFiles=fileHelpers.isMultipartForm(formFields);validationError=null;formFields.forEach(function(field){if(field.type==='file'){var fileInput=document.querySelector(\"input[name=\\\"\".concat(field.name||'file',\"\\\"]\"));if(fileInput.files.length>0){var firstFile=fileInput.files[0];formData.append(field.name||'file',firstFile,firstFile.name);}return;}finalObject[field.name]=field.value;if(containFiles){formData.append(field.name,field.value);}if(field.required&&field.type!=='boolean'&&!field.value){validationError='Please fill up all required fields.';}if(dataHelpers.checkIfFieldIsObject(field)&&field.value){try{finalObject[field.name]=JSON.parse(field.value);}catch(e){validationError=\"Invalid JSON for field \\\"\".concat(field.name,\"\\\".\");}}if(field.type==='boolean'){finalObject[field.name]=field.value||false;}if(field.type==='encode'){finalObject[field.name]=encodeURIComponent(field.value);}});if(!validationError){_context2.next=9;break;}toast.error(validationError);return _context2.abrupt(\"return\");case 9:setLoading(true);_context2.prev=10;_body=containFiles?formData:unflatten(finalObject);_context2.next=14;return _regeneratorRuntime.awrap(submitCallback(_body,containFiles));case 14:toast.success('Great Success!');_closeCallback(true);_context2.next=21;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](10);toast.error(_context2.t0.message);case 21:setLoading(false);case 22:case\"end\":return _context2.stop();}}},null,null,[[10,18]]);}function formChanged(fieldName,value){var updatedFormFields=JSON.parse(JSON.stringify(formFields));updatedFormFields=updatedFormFields.map(function(field){if(field.name===fieldName){field.value=value;}return field;});setFormFields(updatedFormFields);}useEffect(function(){initFormFields();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return React.createElement(Popup,{show:true,className:\"form-popup\",closeCallback:function closeCallback(){return _closeCallback(false);},customLabels:customLabels},React.createElement(React.Fragment,null,React.createElement(\"h2\",null,title),React.createElement(\"section\",null,loading?React.createElement(Loader,null):React.createElement(\"form\",{onSubmit:submitForm},formFields.map(function(field,idx){return React.createElement(FormRow,{key:\"field_\".concat(idx),field:field,onChange:formChanged,showReset:!field.type||field.type==='text'});}),React.createElement(\"div\",{className:\"buttons-wrapper center\"},React.createElement(Button,{type:\"submit\",onClick:submitForm,color:\"green\"},\"Submit\"))))));});","map":{"version":3,"sources":["/Users/claire/Desktop/covid-trend/RESTool2/src/components/formPopup/formPopup.comp.tsx"],"names":["React","useState","useEffect","toast","Popup","FormRow","Button","Loader","dataHelpers","fileHelpers","withAppContext","flatten","require","unflatten","FormPopup","context","title","fields","rawData","getSingleConfig","methodConfig","submitCallback","closeCallback","fieldsCopy","JSON","parse","stringify","httpService","activePage","config","loading","setLoading","formFields","setFormFields","finalRawData","setFinalRawData","pageHeaders","requestHeaders","customLabels","initFormFields","url","actualMethod","dataPath","queryParams","fetch","method","origUrl","headers","Object","assign","result","extractedData","extractDataByDataPath","console","error","flattenData","map","field","key","name","originalName","checkIfFieldIsObject","value","type","submitForm","e","preventDefault","finalObject","includeOriginalFields","formData","FormData","containFiles","isMultipartForm","validationError","forEach","fileInput","document","querySelector","files","length","firstFile","append","required","encodeURIComponent","body","success","message","formChanged","fieldName","updatedFormFields","idx"],"mappings":"ydAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,KAAT,KAAsB,gBAAtB,CAEA,OAASC,KAAT,KAAsB,qBAAtB,CAQA,OAASC,OAAT,KAAwB,yBAAxB,CACA,OAASC,MAAT,KAAuB,uBAAvB,CACA,OAASC,MAAT,KAAuB,uBAAvB,CACA,OAASC,WAAT,KAA4B,4BAA5B,CACA,OAASC,WAAT,KAA4B,4BAA5B,CAEA,OAASC,cAAT,KAA+B,iCAA/B,CAEA,MAAO,kBAAP,CAEA,GAAMC,CAAAA,OAAO,CAAGC,OAAO,CAAC,MAAD,CAAvB,CACA,GAAMC,CAAAA,SAAS,CAAGD,OAAO,CAAC,MAAD,CAAP,CAAgBC,SAAlC,CAaA,MAAO,IAAMC,CAAAA,SAAS,CAAGJ,cAAc,CAAC,cAA+G,IAA5GK,CAAAA,OAA4G,MAA5GA,OAA4G,CAAnGC,KAAmG,MAAnGA,KAAmG,CAA5FC,MAA4F,MAA5FA,MAA4F,CAApFC,OAAoF,MAApFA,OAAoF,CAA3EC,eAA2E,MAA3EA,eAA2E,CAA1DC,YAA0D,MAA1DA,YAA0D,CAA5CC,cAA4C,MAA5CA,cAA4C,CAA5BC,cAA4B,MAA5BA,aAA4B,CACrJ,GAAMC,CAAAA,UAA+B,CAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeT,MAAf,CAAX,CAAxC,CADqJ,GAE7IU,CAAAA,WAF6I,CAEzGZ,OAFyG,CAE7IY,WAF6I,CAEhIC,UAFgI,CAEzGb,OAFyG,CAEhIa,UAFgI,CAEpHC,MAFoH,CAEzGd,OAFyG,CAEpHc,MAFoH,eAGvH5B,QAAQ,CAAU,IAAV,CAH+G,wCAG9I6B,OAH8I,eAGrIC,UAHqI,8BAIjH9B,QAAQ,CAAsB,EAAtB,CAJyG,yCAI9I+B,UAJ8I,eAIlIC,aAJkI,8BAK7GhC,QAAQ,CAAM,IAAN,CALqG,yCAK9IiC,YAL8I,eAKhIC,eALgI,eAMrJ,GAAMC,CAAAA,WAAgB,CAAG,CAAAR,UAAU,OAAV,EAAAA,UAAU,SAAV,QAAAA,UAAU,CAAES,cAAZ,GAA8B,EAAvD,CACA,GAAMC,CAAAA,YAAuC,kBAAQT,MAAR,SAAQA,MAAR,iBAAQA,MAAM,CAAES,YAAhB,IAAiCV,UAAjC,SAAiCA,UAAjC,iBAAiCA,UAAU,CAAEU,YAA7C,CAA7C,CAEA,QAAeC,CAAAA,cAAf,kOACML,YADN,CAC0BhB,OAAO,EAAI,EADrC,MAGMC,eAAe,EAAIA,eAAe,CAACqB,GAHzC,2CAKcA,GALd,CAK2ErB,eAL3E,CAKcqB,GALd,CAKmBH,cALnB,CAK2ElB,eAL3E,CAKmBkB,cALnB,CAKmCI,YALnC,CAK2EtB,eAL3E,CAKmCsB,YALnC,CAKiDC,QALjD,CAK2EvB,eAL3E,CAKiDuB,QALjD,CAK2DC,WAL3D,CAK2ExB,eAL3E,CAK2DwB,WAL3D,kDAM2BhB,WAAW,CAACiB,KAAZ,CAAkB,CACrCC,MAAM,CAAEJ,YAAY,EAAI,KADa,CAErCK,OAAO,CAAEN,GAF4B,CAGrCG,WAAW,CAAXA,WAHqC,CAIrCI,OAAO,CAAEC,MAAM,CAACC,MAAP,CAAc,EAAd,CAAkBb,WAAlB,CAAgCC,cAAc,EAAI,EAAlD,CAJ4B,CAKrCnB,OAAO,CAAPA,OALqC,CAAlB,CAN3B,SAMYgC,MANZ,eAcYC,aAdZ,CAc4B3C,WAAW,CAAC4C,qBAAZ,CAAkCF,MAAlC,CAA0CR,QAA1C,CAd5B,CAgBM,GAAIS,aAAa,EAAI,MAAOA,CAAAA,aAAP,GAAyB,QAA9C,CAAwD,CACtDjB,YAAY,CAAGiB,aAAf,CACD,CAlBP,iFAoBME,OAAO,CAACC,KAAR,CAAc,qCAAd,cACAnD,KAAK,CAACmD,KAAN,CAAY,qCAAZ,EArBN,QAyBEnB,eAAe,CAACD,YAAD,CAAf,CAA+B;AAEzBqB,WA3BR,CA2BsB5C,OAAO,CAACuB,YAAY,EAAI,EAAjB,CA3B7B,CA6BED,aAAa,CAACV,UAAU,CAACiC,GAAX,CAAe,SAACC,KAAD,CAAW,CACtC,GAAIC,CAAAA,GAAG,CAAGD,KAAK,CAACE,IAAhB,CAEAF,KAAK,CAACG,YAAN,CAAqBH,KAAK,CAACE,IAA3B,CAEA,GAAIF,KAAK,CAACf,QAAV,CAAoB,CAClBgB,GAAG,WAAMD,KAAK,CAACf,QAAZ,aAAwBe,KAAK,CAACE,IAA9B,CAAH,CACD,CAED;AACA;AACAF,KAAK,CAACE,IAAN,CAAaD,GAAb,CAEA,GAAIlD,WAAW,CAACqD,oBAAZ,CAAiCJ,KAAjC,CAAJ,CAA6C,CAC3C,GAAIvB,YAAY,CAACwB,GAAD,CAAZ,EAAqBD,KAAK,CAACK,KAA/B,CAAsC,CACpCL,KAAK,CAACK,KAAN,CAActC,IAAI,CAACE,SAAL,CAAeQ,YAAY,CAACwB,GAAD,CAAZ,EAAqBD,KAAK,CAACK,KAA1C,CAAiD,IAAjD,CAAuD,IAAvD,GAAgE,EAA9E,CACD,CACD,MAAOL,CAAAA,KAAP,CACD,CAED,GAAIA,KAAK,CAACM,IAAN,GAAe,OAAnB,CAA4B,CAC1BN,KAAK,CAACK,KAAN,CAAc5B,YAAY,CAACwB,GAAD,CAAZ,EAAqBD,KAAK,CAACK,KAA3B,EAAoC,EAAlD,CACA,MAAOL,CAAAA,KAAP,CACD,CAED,GAAI,MAAOF,CAAAA,WAAW,CAACG,GAAD,CAAlB,GAA4B,WAAhC,CAA6C,CAC3CD,KAAK,CAACK,KAAN,CAAcP,WAAW,CAACG,GAAD,CAAzB,CACD,CAFD,IAEO,CACL;AACAD,KAAK,CAACK,KAAN,CAAc,MAAOL,CAAAA,KAAK,CAACK,KAAb,GAAuB,WAAvB,CAAqC,EAArC,CAA0CL,KAAK,CAACK,KAA9D,CACD,CAED,MAAOL,CAAAA,KAAP,CACD,CAjCa,CAAD,CAAb,CAmCA1B,UAAU,CAAC,KAAD,CAAV,CAhEF,kEAmEA,QAAeiC,CAAAA,UAAf,CAA0BC,CAA1B,qLACEA,CAAC,CAACC,cAAF,GAEMC,WAHR,CAG4B/C,YAAD,CAAmCgD,qBAAnC,CAA2DpB,MAAM,CAACC,MAAP,CAAc,EAAd,CAAkBf,YAAlB,CAA3D,CAA6F,EAHxH,CAIQmC,QAJR,CAImB,GAAIC,CAAAA,QAAJ,EAJnB,CAKQC,YALR,CAKgC9D,WAAW,CAAC+D,eAAZ,CAA4BxC,UAA5B,CALhC,CAMMyC,eANN,CAMwB,IANxB,CAQEzC,UAAU,CAAC0C,OAAX,CAAmB,SAACjB,KAAD,CAAW,CAC5B,GAAIA,KAAK,CAACM,IAAN,GAAe,MAAnB,CAA2B,CACzB,GAAMY,CAAAA,SAAc,CAAGC,QAAQ,CAACC,aAAT,wBAAsCpB,KAAK,CAACE,IAAN,EAAc,MAApD,QAAvB,CAEA,GAAIgB,SAAS,CAACG,KAAV,CAAgBC,MAAhB,CAAyB,CAA7B,CAAgC,CAC9B,GAAMC,CAAAA,SAAS,CAAGL,SAAS,CAACG,KAAV,CAAgB,CAAhB,CAAlB,CACAT,QAAQ,CAACY,MAAT,CAAgBxB,KAAK,CAACE,IAAN,EAAc,MAA9B,CAAsCqB,SAAtC,CAAiDA,SAAS,CAACrB,IAA3D,EACD,CACD,OACD,CAEDQ,WAAW,CAACV,KAAK,CAACE,IAAP,CAAX,CAA0BF,KAAK,CAACK,KAAhC,CAEA,GAAIS,YAAJ,CAAkB,CAChBF,QAAQ,CAACY,MAAT,CAAgBxB,KAAK,CAACE,IAAtB,CAA4BF,KAAK,CAACK,KAAlC,EACD,CAED,GAAIL,KAAK,CAACyB,QAAN,EAAkBzB,KAAK,CAACM,IAAN,GAAe,SAAjC,EAA8C,CAACN,KAAK,CAACK,KAAzD,CAAgE,CAC9DW,eAAe,CAAG,qCAAlB,CACD,CAED,GAAIjE,WAAW,CAACqD,oBAAZ,CAAiCJ,KAAjC,GAA2CA,KAAK,CAACK,KAArD,CAA4D,CAC1D,GAAI,CACFK,WAAW,CAACV,KAAK,CAACE,IAAP,CAAX,CAA0BnC,IAAI,CAACC,KAAL,CAAWgC,KAAK,CAACK,KAAjB,CAA1B,CACD,CAAC,MAAOG,CAAP,CAAU,CACVQ,eAAe,oCAA8BhB,KAAK,CAACE,IAApC,OAAf,CACD,CACF,CAED,GAAIF,KAAK,CAACM,IAAN,GAAe,SAAnB,CAA8B,CAC5BI,WAAW,CAACV,KAAK,CAACE,IAAP,CAAX,CAA0BF,KAAK,CAACK,KAAN,EAAe,KAAzC,CACD,CAED,GAAIL,KAAK,CAACM,IAAN,GAAe,QAAnB,CAA6B,CAC3BI,WAAW,CAACV,KAAK,CAACE,IAAP,CAAX,CAA0BwB,kBAAkB,CAAC1B,KAAK,CAACK,KAAP,CAA5C,CACD,CACF,CApCD,EARF,IA8CMW,eA9CN,0BA+CItE,KAAK,CAACmD,KAAN,CAAYmB,eAAZ,EA/CJ,yCAmDE1C,UAAU,CAAC,IAAD,CAAV,CAnDF,kBAsDUqD,KAtDV,CAsDiBb,YAAY,CAAGF,QAAH,CAAcxD,SAAS,CAACsD,WAAD,CAtDpD,oDAuDU9C,cAAc,CAAC+D,KAAD,CAAOb,YAAP,CAvDxB,UAyDIpE,KAAK,CAACkF,OAAN,CAAc,gBAAd,EAEA/D,cAAa,CAAC,IAAD,CAAb,CA3DJ,sFA6DInB,KAAK,CAACmD,KAAN,CAAY,aAAEgC,OAAd,EA7DJ,QAgEEvD,UAAU,CAAC,KAAD,CAAV,CAhEF,oEAmEA,QAASwD,CAAAA,WAAT,CAAqBC,SAArB,CAAwC1B,KAAxC,CAAoD,CAClD,GAAI2B,CAAAA,iBAAsC,CAAGjE,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeM,UAAf,CAAX,CAA7C,CAEAyD,iBAAiB,CAAGA,iBAAiB,CAACjC,GAAlB,CAAsB,SAACC,KAAD,CAA8B,CACtE,GAAIA,KAAK,CAACE,IAAN,GAAe6B,SAAnB,CAA8B,CAC5B/B,KAAK,CAACK,KAAN,CAAcA,KAAd,CACD,CAED,MAAOL,CAAAA,KAAP,CACD,CANmB,CAApB,CAQAxB,aAAa,CAACwD,iBAAD,CAAb,CACD,CAEDvF,SAAS,CAAC,UAAM,CACdqC,cAAc,GACd;AACD,CAHQ,CAGN,EAHM,CAAT,CAKA,MACE,qBAAC,KAAD,EACE,IAAI,CAAE,IADR,CAEE,SAAS,CAAC,YAFZ,CAGE,aAAa,CAAE,+BAAMjB,CAAAA,cAAa,CAAC,KAAD,CAAnB,EAHjB,CAIE,YAAY,CAAEgB,YAJhB,EAME,oBAAC,KAAD,CAAO,QAAP,MACE,8BAAKtB,KAAL,CADF,CAEE,mCAEIc,OAAO,CACP,oBAAC,MAAD,MADO,CAEP,4BAAM,QAAQ,CAAEkC,UAAhB,EAEIhC,UAAU,CAACwB,GAAX,CAAe,SAACC,KAAD,CAAQiC,GAAR,CAAgB,CAC7B,MACE,qBAAC,OAAD,EACE,GAAG,iBAAWA,GAAX,CADL,CAEE,KAAK,CAAEjC,KAFT,CAGE,QAAQ,CAAE8B,WAHZ,CAIE,SAAS,CAAE,CAAC9B,KAAK,CAACM,IAAP,EAAeN,KAAK,CAACM,IAAN,GAAe,MAJ3C,EADF,CAQD,CATD,CAFJ,CAaE,2BAAK,SAAS,CAAC,wBAAf,EACE,oBAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAEC,UAA/B,CAA2C,KAAK,CAAC,OAAjD,WADF,CAbF,CAJJ,CAFF,CANF,CADF,CAmCD,CArMsC,CAAhC","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { toast } from 'react-toastify';\n\nimport { Popup } from '../popup/popup.comp';\nimport {\n  IConfigInputField,\n  IConfigGetSingleMethod,\n  IConfigPostMethod,\n  IConfigPutMethod,\n  ICustomLabels\n} from '../../common/models/config.model';\nimport { FormRow } from '../formRow/formRow.comp';\nimport { Button } from '../button/button.comp';\nimport { Loader } from '../loader/loader.comp';\nimport { dataHelpers } from '../../helpers/data.helpers';\nimport { fileHelpers } from '../../helpers/file.helpers';\nimport { IAppContext } from '../app.context';\nimport { withAppContext } from '../withContext/withContext.comp';\n\nimport './formPopup.scss';\n\nconst flatten = require('flat');\nconst unflatten = require('flat').unflatten;\n\ninterface IProps {\n  context: IAppContext\n  title: string\n  fields: IConfigInputField[]\n  rawData?: any\n  getSingleConfig?: IConfigGetSingleMethod\n  methodConfig: IConfigPostMethod | IConfigPutMethod\n  closeCallback: (reloadData: boolean) => void\n  submitCallback: (body: any, containFiles: boolean) => void\n}\n\nexport const FormPopup = withAppContext(({ context, title, fields, rawData, getSingleConfig, methodConfig, submitCallback, closeCallback }: IProps) => {\n  const fieldsCopy: IConfigInputField[] = JSON.parse(JSON.stringify(fields));\n  const { httpService, activePage, config } = context;\n  const [loading, setLoading] = useState<boolean>(true);\n  const [formFields, setFormFields] = useState<IConfigInputField[]>([]);\n  const [finalRawData, setFinalRawData] = useState<any>(null);\n  const pageHeaders: any = activePage?.requestHeaders || {};\n  const customLabels: ICustomLabels | undefined = { ...config?.customLabels, ...activePage?.customLabels };\n\n  async function initFormFields() {\n    let finalRawData: any = rawData || {};\n\n    if (getSingleConfig && getSingleConfig.url) {\n      try {\n        const { url, requestHeaders, actualMethod, dataPath, queryParams } = getSingleConfig;\n        const result = await httpService.fetch({\n          method: actualMethod || 'get',\n          origUrl: url,\n          queryParams,\n          headers: Object.assign({}, pageHeaders,  requestHeaders || {}),\n          rawData,\n        });\n\n        const extractedData = dataHelpers.extractDataByDataPath(result, dataPath);\n\n        if (extractedData && typeof extractedData === 'object') {\n          finalRawData = extractedData;\n        }\n      } catch (e) {\n        console.error('Could not load single item\\'s data.', e);\n        toast.error('Could not load single item\\'s data.');\n      }\n    }\n\n    setFinalRawData(finalRawData); // Store the raw data for later.\n\n    const flattenData = flatten(finalRawData || {});\n\n    setFormFields(fieldsCopy.map((field) => {\n      let key = field.name;\n\n      field.originalName = field.name;\n\n      if (field.dataPath) {\n        key = `${field.dataPath}.${field.name}`;\n      }\n\n      // Changing field name to include datapath\n      // This will use us later for unflatten the final object\n      field.name = key;\n\n      if (dataHelpers.checkIfFieldIsObject(field)) {\n        if (finalRawData[key] || field.value) {\n          field.value = JSON.stringify(finalRawData[key] || field.value, null, '  ') || '';\n        }\n        return field;\n      }\n\n      if (field.type === 'array') {\n        field.value = finalRawData[key] || field.value || [];\n        return field;\n      }\n\n      if (typeof flattenData[key] !== 'undefined') {\n        field.value = flattenData[key];\n      } else {\n        // important in order to prevent controlled / uncontrolled components error\n        field.value = typeof field.value === 'undefined' ? '' : field.value;\n      }\n\n      return field;\n    }));\n\n    setLoading(false);\n  }\n\n  async function submitForm(e: any) {\n    e.preventDefault();\n\n    const finalObject: any = (methodConfig as IConfigPutMethod).includeOriginalFields ? Object.assign({}, finalRawData) : {};\n    const formData = new FormData();\n    const containFiles: boolean = fileHelpers.isMultipartForm(formFields);\n    let validationError = null;\n\n    formFields.forEach((field) => {\n      if (field.type === 'file') {\n        const fileInput: any = document.querySelector(`input[name=\"${field.name || 'file'}\"]`) as HTMLInputElement;\n\n        if (fileInput.files.length > 0) {\n          const firstFile = fileInput.files[0];\n          formData.append(field.name || 'file', firstFile, firstFile.name);\n        }\n        return;\n      }\n\n      finalObject[field.name] = field.value;\n\n      if (containFiles) {\n        formData.append(field.name, field.value);\n      }\n\n      if (field.required && field.type !== 'boolean' && !field.value) {\n        validationError = 'Please fill up all required fields.';\n      }\n\n      if (dataHelpers.checkIfFieldIsObject(field) && field.value) {\n        try {\n          finalObject[field.name] = JSON.parse(field.value);\n        } catch (e) {\n          validationError = `Invalid JSON for field \"${field.name}\".`;\n        }\n      }\n\n      if (field.type === 'boolean') {\n        finalObject[field.name] = field.value || false;\n      }\n\n      if (field.type === 'encode') {\n        finalObject[field.name] = encodeURIComponent(field.value);\n      }\n    });\n\n    if (validationError) {\n      toast.error(validationError);\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const body = containFiles ? formData : unflatten(finalObject);\n      await submitCallback(body, containFiles);\n\n      toast.success('Great Success!');\n\n      closeCallback(true);\n    } catch (e) {\n      toast.error(e.message);\n    }\n\n    setLoading(false);\n  }\n\n  function formChanged(fieldName: string, value: any) {\n    let updatedFormFields: IConfigInputField[] = JSON.parse(JSON.stringify(formFields));\n\n    updatedFormFields = updatedFormFields.map((field: IConfigInputField) => {\n      if (field.name === fieldName) {\n        field.value = value;\n      }\n\n      return field;\n    });\n\n    setFormFields(updatedFormFields);\n  }\n\n  useEffect(() => {\n    initFormFields();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Popup\n      show={true}\n      className=\"form-popup\"\n      closeCallback={() => closeCallback(false)}\n      customLabels={customLabels}\n    >\n      <React.Fragment>\n        <h2>{title}</h2>\n        <section>\n          {\n            loading ?\n            <Loader /> :\n            <form onSubmit={submitForm}>\n              {\n                formFields.map((field, idx) => {\n                  return (\n                    <FormRow\n                      key={`field_${idx}`}\n                      field={field}\n                      onChange={formChanged}\n                      showReset={!field.type || field.type === 'text'}\n                    />\n                  );\n                })\n              }\n              <div className=\"buttons-wrapper center\">\n                <Button type=\"submit\" onClick={submitForm} color=\"green\">Submit</Button>\n              </div>\n            </form>\n          }\n        </section>\n      </React.Fragment>\n    </Popup>\n  );\n});\n"]},"metadata":{},"sourceType":"module"}